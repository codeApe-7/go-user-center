services:
  backend:
    build:
      context: ./backend
    container_name: go-user-center-backend
    restart: unless-stopped
    environment:
      # 使用现有 MySQL 容器（mysql-production）
      # 建议在 .env 中配置 DB_DSN，例如：
      # DB_DSN=go_uc:your_pass@tcp(mysql-production:3306)/go_user_center?charset=utf8mb4&parseTime=True&loc=Local
      DB_DSN: "${DB_DSN}"
      SERVER_ADDR: ":18601"
      JWT_SECRET: "${JWT_SECRET:-dev-secret-change-me}"
      JWT_ISSUER: "go-user-center"
      JWT_ACCESSTTL: "30m"
    networks:
      - default
      - polynba_net
    ports:
      - "18601:18601"

  frontend:
    build:
      context: ./frontend
    container_name: go-user-center-frontend
    restart: unless-stopped
    depends_on:
      - backend
    ports:
      - "3301:80"

networks:
  polynba_net:
    external: true
    name: polynba-mysql_lsky-net
